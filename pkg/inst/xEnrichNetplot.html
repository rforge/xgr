<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title></title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for xEnrichNetplot"><tr><td>xEnrichNetplot</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>xEnrichNetplot</h2>

<h3>Usage</h3>

<pre>
xEnrichNetplot(eTerm, top_num = 10, displayBy = c("fc", "adjp", "fdr",
"zscore", "pvalue"), path.mode = c("all_paths", "shortest_paths",
"all_shortest_paths"), node.info = c("none", "term_id", "term_name",
"both", "full_term_name"), wrap.width = 15, colormap = c("yr", "jet",
"gbr", "wyr", "br", "bwr", "rainbow", "wb"), ncolors = 40, zlim = NULL,
colorbar = T, newpage = T, glayout = layout_as_tree, vertex.frame.color
= NA, vertex.size = NULL, vertex.color = NULL, vertex.shape = NULL,
vertex.label = NULL, vertex.label.cex = NULL, vertex.label.dist = 0.3,
vertex.label.color = "blue", edge.arrow.size = 0.3, ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>eTerm</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>top_num</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>displayBy</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>path.mode</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>node.info</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>wrap.width</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>colormap</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>ncolors</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>zlim</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>colorbar</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>newpage</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>glayout</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>vertex.frame.color</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>vertex.size</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>vertex.color</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>vertex.shape</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>vertex.label</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>vertex.label.cex</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>vertex.label.dist</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>vertex.label.color</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>edge.arrow.size</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>


</td></tr>
</table>


<h3>Examples</h3>

<pre>
##---- Should be DIRECTLY executable !! ----
##-- ==&gt;  Define data, use random,
##--	or do  help(data=index)  for the standard data sets.

## The function is currently defined as
function (eTerm, top_num = 10, displayBy = c("fc", "adjp", "fdr",
"zscore", "pvalue"), path.mode = c("all_paths", "shortest_paths",
"all_shortest_paths"), node.info = c("none", "term_id", "term_name",
"both", "full_term_name"), wrap.width = 15, colormap = c("yr",
"jet", "gbr", "wyr", "br", "bwr", "rainbow", "wb"), ncolors = 40,
zlim = NULL, colorbar = T, newpage = T, glayout = layout_as_tree,
vertex.frame.color = NA, vertex.size = NULL, vertex.color = NULL,
vertex.shape = NULL, vertex.label = NULL, vertex.label.cex = NULL,
vertex.label.dist = 0.3, vertex.label.color = "blue", edge.arrow.size =
0.3,
...)
{
displayBy &lt;- match.arg(displayBy)
path.mode &lt;- match.arg(path.mode)
node.info &lt;- match.arg(node.info)
if (is.logical(eTerm)) {
stop("There is no enrichment in the 'eTerm' object.\n")
}
if (class(eTerm)[1] == "eTerm") {
df &lt;- xEnrichViewer(eTerm, top_num = "all")
if (top_num == "auto") {
top_num &lt;- sum(df$adjp &lt; 0.05)
if (top_num &lt;= 1) {
top_num &lt;- sum(df$adjp &lt; 0.1)
}
if (top_num &lt;= 1) {
top_num &lt;- 10
}
}
df &lt;- xEnrichViewer(eTerm, top_num = top_num, sortBy = "adjp")
g &lt;- eTerm$g
nodes_query &lt;- rownames(df)
subg &lt;- dnet::dDAGinduce(g, nodes_query, path.mode = path.mode)
if (displayBy == "adjp" | displayBy == "fdr") {
data &lt;- -1 * log10(df$adjp)
}
else if (displayBy == "fc") {
data &lt;- df$fc
}
else if (displayBy == "pvalue") {
data &lt;- -1 * log10(df$pvalue)
}
else if (displayBy == "zscore") {
data &lt;- df$zscore
}
names(data) &lt;- rownames(df)
ind &lt;- match(V(subg)$name, names(data))
data &lt;- data[ind]
names(data) &lt;- V(subg)$name
}
else if (any(class(eTerm) %in% c("gg", "ggplot"))) {
bp &lt;- eTerm
if (!is.null(bp$g)) {
bp_ig &lt;- bp$g
bp_data &lt;- bp$data
nodes_query &lt;- unique(bp_data$id)
subg &lt;- dDAGinduce(g = bp_ig, nodes_query = nodes_query,
path.mode = path.mode)
data &lt;- bp_data$nSig
if (is.null(zlim)) {
zlim &lt;- c(0, max(data))
}
}
else {
stop("No 'igraph' object can not be found in the input 'ggplot'
object.\n")
}
}
else {
stop("Cannot find either an 'eTerm' object or an 'ggplot' object.\n")
}
if (is.null(vertex.label)) {
getTermInfo &lt;- function(g, vids, numChar = 15, mulLines = F) {
fullNames &lt;- V(g)[vids]$term_name
names(fullNames) &lt;- V(g)[vids]$name
if (mulLines == F) {
shortNames &lt;- paste(substr(fullNames, 1, numChar),
ifelse(nchar(fullNames) &gt; numChar, "...", ""),
sep = "")
}
else {
shortNames &lt;- sapply(fullNames, function(x) {
return(paste(strwrap(x, numChar), sep = "",
collapse = "\n"))
})
}
names(shortNames) &lt;- names(fullNames)
return(shortNames)
}
termNames &lt;- getTermInfo(subg, vids = V(subg)$term_id,
numChar = 15, mulLines = F)
vertex.label &lt;- switch(node.info, none = NULL, term_id =
V(subg)$term_id,
term_name = V(subg)$term_name, both = paste(V(subg)$term_id,
termNames, sep = "\n"), full_term_name = getTermInfo(subg,
vids = V(subg)$term_id, numChar = wrap.width,
mulLines = T))
}
pattern &lt;- data
if (!is.null(pattern)) {
flag &lt;- 0
if (!is.null(names(pattern))) {
pattern &lt;- pattern[V(subg)$name]
}
if (length(pattern) == vcount(subg)) {
flag &lt;- 1
}
if (flag == 1) {
pattern &lt;- as.numeric(pattern)
pattern_nona &lt;- pattern[!is.na(pattern)]
pattern_nona &lt;- as.numeric(pattern_nona)
if (is.null(zlim)) {
vmin &lt;- floor(stats::quantile(pattern_nona, 0.05))
vmax &lt;- ceiling(stats::quantile(pattern_nona,
0.95))
if (vmin &lt; 0 &amp; vmax &gt; 0) {
vsym &lt;- abs(min(vmin, vmax))
vmin &lt;- -1 * vsym
vmax &lt;- vsym
}
zlim &lt;- c(vmin, vmax)
}
vec2color &lt;- function(vec, colormap = colormap, ncolors = ncolors,
zlim = zlim) {
palette.name &lt;- supraHex::visColormap(colormap = colormap)
colors &lt;- palette.name(ncolors)
scale &lt;- length(colors)/(max(zlim) - min(zlim))
sapply(1:length(vec), function(x) {
if (is.na(vec[x])) {
"transparent"
}
else {
ind &lt;- floor(1 + (vec[x] - min(zlim)) * scale)
colors[max(1, min(ncolors, ind))]
}
})
}
vertex.color &lt;- vec2color(pattern, colormap = colormap,
ncolors = ncolors, zlim = zlim)
vertex.frame.color &lt;- vec2color(pattern, colormap = colormap,
ncolors = ncolors, zlim = zlim)
vertex.frame.color[vertex.frame.color == "transparent"] &lt;- "grey"
}
else {
warning("The input 'pattern' is ignored. Please check the help for
enabling your input")
pattern &lt;- NULL
if (is.null(vertex.color)) {
vertex.color &lt;- "SkyBlue2"
}
}
}
else {
if (is.null(vertex.color)) {
vertex.color &lt;- "SkyBlue2"
}
}
V(subg)$enrichment &lt;- pattern
par_old &lt;- graphics::par()
dnet::visNet(g = subg, pattern = pattern, colormap = colormap,
ncolors = ncolors, zlim = zlim, colorbar = colorbar,
newpage = newpage, glayout = glayout, vertex.frame.color =
vertex.frame.color,
vertex.size = vertex.size, vertex.color = vertex.color,
vertex.shape = vertex.shape, vertex.label = vertex.label,
vertex.label.cex = vertex.label.cex, vertex.label.dist =
vertex.label.dist,
vertex.label.color = vertex.label.color, edge.arrow.size =
edge.arrow.size,
...)
suppressWarnings(graphics::par(par_old))
invisible(subg)
}
</pre>


</body></html>
