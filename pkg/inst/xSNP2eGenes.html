<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title></title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for xSNP2eGenes"><tr><td>xSNP2eGenes</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>xSNP2eGenes</h2>

<h3>Usage</h3>

<pre>
xSNP2eGenes(data, include.eQTL = NA, eQTL.customised = NULL,
cdf.function = c("empirical", "exponential"), plot = FALSE, verbose =
TRUE, RData.location = "http://galahad.well.ox.ac.uk/bigdata", guid =
NULL)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>data</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>include.eQTL</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>eQTL.customised</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>cdf.function</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>plot</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>verbose</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>RData.location</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>guid</code></td>
<td>


</td></tr>
</table>


<h3>Examples</h3>

<pre>
##---- Should be DIRECTLY executable !! ----
##-- ==&gt;  Define data, use random,
##--	or do  help(data=index)  for the standard data sets.

## The function is currently defined as
function (data, include.eQTL = NA, eQTL.customised = NULL, cdf.function
= c("empirical",
"exponential"), plot = FALSE, verbose = TRUE, RData.location =
"http://galahad.well.ox.ac.uk/bigdata",
guid = NULL)
{
cdf.function &lt;- match.arg(cdf.function)
data &lt;- gsub("_", ":", data, perl = TRUE)
data &lt;- gsub("imm:", "chr", data, perl = TRUE)
data &lt;- unique(data)
if (verbose) {
now &lt;- Sys.time()
message(sprintf("A total of %d SNPs are input", length(data)),
appendLF = TRUE)
}
df_SGS &lt;- xDefineEQTL(data = NULL, include.eQTL = include.eQTL,
eQTL.customised = eQTL.customised, verbose = verbose,
RData.location = RData.location, guid = guid)
if (!is.null(df_SGS)) {
uid &lt;- paste(df_SGS[, 1], df_SGS[, 2], sep = "_")
df &lt;- cbind(uid, df_SGS)
res_list &lt;- split(x = df$Sig, f = df$uid)
vec &lt;- unlist(lapply(res_list, min))
raw_score &lt;- -1 * log10(vec)
if (cdf.function == "exponential") {
lambda &lt;- MASS::fitdistr(raw_score, "exponential")$estimate
ind &lt;- match(df_SGS[, 1], data)
df &lt;- data.frame(df_SGS[!is.na(ind), ])
wE &lt;- stats::pexp(-log10(df$Sig), rate = lambda)
if (nrow(df) == 0) {
df_eGenes &lt;- NULL
}
else {
df_eGenes &lt;- data.frame(Gene = df$Gene, SNP = df$SNP,
Sig = df$Sig, Weight = wE, row.names = NULL,
stringsAsFactors = FALSE)
}
if (plot) {
hist(raw_score, breaks = 1000, freq = FALSE,
col = "grey", xlab = "-log10(p-values)", main = "")
curve(stats::dexp(x = raw_score, rate = lambda),
0:max(raw_score), col = 2, add = TRUE)
}
if (verbose) {
now &lt;- Sys.time()
message(sprintf("eQTL weights are CDF of exponential empirical
distributions (parameter lambda=%f)",
lambda), appendLF = TRUE)
}
}
else if (cdf.function == "empirical") {
my.CDF &lt;- stats::ecdf(raw_score)
ind &lt;- match(df_SGS[, 1], data)
df &lt;- data.frame(df_SGS[!is.na(ind), ])
wE &lt;- my.CDF(-log10(df$Sig))
if (nrow(df) == 0) {
df_eGenes &lt;- NULL
}
else {
df_eGenes &lt;- data.frame(Gene = df$Gene, SNP = df$SNP,
Sig = df$Sig, Weight = wE, row.names = NULL,
stringsAsFactors = FALSE)
df_eGenes &lt;- df_eGenes[order(df_eGenes$Gene,
df_eGenes$Sig, df_eGenes$SNP, decreasing = FALSE),
]
}
if (plot) {
plot(my.CDF, xlab = "-log10(p-values)", ylab = "Empirical CDF (eQTL
weights)",
main = "")
}
if (verbose) {
now &lt;- Sys.time()
message(sprintf("eQTL weights are CDF of empirical distributions"),
appendLF = TRUE)
}
}
if (verbose) {
now &lt;- Sys.time()
message(sprintf("%d eGenes are defined involving %d eQTL",
length(unique(df_eGenes$Gene)), length(unique(df_eGenes$SNP))),
appendLF = TRUE)
}
}
else {
df_eGenes &lt;- NULL
if (verbose) {
now &lt;- Sys.time()
message(sprintf("No eQTL genes are defined"), appendLF = TRUE)
}
}
if (!is.null(df_eGenes)) {
ind &lt;- xSymbol2GeneID(df_eGenes$Gene, details = FALSE,
verbose = verbose, RData.location = RData.location,
guid = guid)
df_eGenes &lt;- df_eGenes[!is.na(ind), ]
if (nrow(df_eGenes) == 0) {
df_eGenes &lt;- NULL
}
}
invisible(df_eGenes)
}
</pre>


</body></html>
