<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title></title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for xEnricherSNPs"><tr><td>xEnricherSNPs</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>xEnricherSNPs</h2>

<h3>Usage</h3>

<pre>
xEnricherSNPs(data, background = NULL, ontology = c("EF", "EF_disease",
"EF_phenotype", "EF_bp"), include.LD = NA, LD.r2 = 0.8, size.range =
c(10, 2000), min.overlap = 5, which.distance = NULL, test = c("fisher",
"hypergeo", "binomial"), background.annotatable.only = NULL, p.tail =
c("one-tail", "two-tails"), p.adjust.method = c("BH", "BY",
"bonferroni", "holm", "hochberg", "hommel"), ontology.algorithm =
c("none", "pc", "elim", "lea"), elim.pvalue = 0.01, lea.depth = 2,
path.mode = c("all_paths", "shortest_paths", "all_shortest_paths"),
true.path.rule = T, verbose = T, silent = FALSE, RData.location =
"http://galahad.well.ox.ac.uk/bigdata", guid = NULL)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>data</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>background</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>ontology</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>include.LD</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>LD.r2</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>size.range</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>min.overlap</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>which.distance</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>test</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>background.annotatable.only</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>p.tail</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>p.adjust.method</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>ontology.algorithm</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>elim.pvalue</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>lea.depth</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>path.mode</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>true.path.rule</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>verbose</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>silent</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>RData.location</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>guid</code></td>
<td>


</td></tr>
</table>


<h3>Examples</h3>

<pre>
##---- Should be DIRECTLY executable !! ----
##-- ==&gt;  Define data, use random,
##--	or do  help(data=index)  for the standard data sets.

## The function is currently defined as
function (data, background = NULL, ontology = c("EF", "EF_disease",
"EF_phenotype", "EF_bp"), include.LD = NA, LD.r2 = 0.8, size.range =
c(10,
2000), min.overlap = 5, which.distance = NULL, test = c("fisher",
"hypergeo", "binomial"), background.annotatable.only = NULL,
p.tail = c("one-tail", "two-tails"), p.adjust.method = c("BH",
"BY", "bonferroni", "holm", "hochberg", "hommel"), ontology.algorithm =
c("none",
"pc", "elim", "lea"), elim.pvalue = 0.01, lea.depth = 2,
path.mode = c("all_paths", "shortest_paths", "all_shortest_paths"),
true.path.rule = T, verbose = T, silent = FALSE, RData.location =
"http://galahad.well.ox.ac.uk/bigdata",
guid = NULL)
{
startT &lt;- Sys.time()
if (!silent) {
message(paste(c("Start at ", as.character(startT)), collapse = ""),
appendLF = TRUE)
message("", appendLF = TRUE)
}
else {
verbose &lt;- FALSE
}
ontology &lt;- match.arg(ontology)
test &lt;- match.arg(test)
p.tail &lt;- match.arg(p.tail)
p.adjust.method &lt;- match.arg(p.adjust.method)
ontology.algorithm &lt;- match.arg(ontology.algorithm)
path.mode &lt;- match.arg(path.mode)
p.tail &lt;- match.arg(p.tail)
if (length(data) == 0) {
return(NULL)
}
if (is.vector(data)) {
data &lt;- unique(data)
}
else {
stop("The input data must be a vector.\n")
}
data &lt;- as.character(data)
if (!is.na(ontology)) {
if (verbose) {
now &lt;- Sys.time()
message(sprintf("Load the ontology %s and its SNP annotations (%s)
...",
ontology, as.character(now)), appendLF = T)
}
ig &lt;- xRDataLoader(RData = paste("ig.EF", sep = ""),
RData.location = RData.location, guid = guid, verbose = verbose)
V(ig)$namespace &lt;- ontology
if (ontology != "EF") {
if (ontology == "EF_disease") {
node &lt;- "EFO:0000408"
}
else if (ontology == "EF_phenotype") {
node &lt;- "EFO:0000651"
}
else if (ontology == "EF_bp") {
node &lt;- "GO:0008150"
}
neighs.out &lt;- igraph::neighborhood(ig, order = vcount(ig),
nodes = node, mode = "out")
nodeInduced &lt;- V(ig)[unique(unlist(neighs.out))]$name
g &lt;- igraph::induced.subgraph(ig, vids = nodeInduced)
V(g)$namespace &lt;- ontology
}
else {
g &lt;- ig
}
if (is.null(V(g)$term_namespace)) {
V(g)$term_namespace &lt;- ontology
}
anno &lt;- xRDataLoader(RData = paste("GWAS2EF", sep = ""),
RData.location = RData.location, guid = guid, verbose = verbose)
if (LD.r2 &gt;= 0.8 &amp; LD.r2 &lt;= 1) {
default.include.LD &lt;- c("ACB", "AFR", "AMR", "ASW",
"BEB", "CDX", "CEU", "CHB", "CHS", "CLM", "EAS",
"ESN", "EUR", "FIN", "GBR", "GIH", "GWD", "IBS",
"ITU", "JPT", "KHV", "LWK", "MSL", "MXL", "PEL",
"PJL", "PUR", "SAS", "STU", "TSI", "YRI")
ind &lt;- match(default.include.LD, include.LD)
include.LD &lt;- default.include.LD[!is.na(ind)]
if (length(include.LD) &gt; 0) {
GWAS_LD &lt;- xRDataLoader(RData = "GWAS_LD", RData.location =
RData.location,
guid = guid, verbose = verbose)
ld.list &lt;- lapply(include.LD, function(x) {
data_ld &lt;- ""
eval(parse(text = paste("data_ld &lt;- GWAS_LD$",
x, sep = "")))
ind &lt;- match(colnames(data_ld), data)
ld &lt;- rownames(data_ld)[which(Matrix::rowSums(data_ld[,
!is.na(ind)] &gt;= LD.r2) &gt; 0)]
ld
})
data &lt;- base::union(unlist(ld.list), data)
}
}
}
else {
stop("There is no input for the ontology.\n")
}
if (verbose) {
now &lt;- Sys.time()
message(sprintf("\n#######################################################",
appendLF = T))
message(sprintf("'xEnricher' is being called (%s):",
as.character(now)), appendLF = T)
message(sprintf("#######################################################",
appendLF = T))
}
eTerm &lt;- xEnricher(data = data, annotation = anno, g = g,
background = background, size.range = size.range, min.overlap =
min.overlap,
which.distance = which.distance, test = test,
background.annotatable.only = background.annotatable.only,
p.tail = p.tail, p.adjust.method = p.adjust.method, ontology.algorithm
= ontology.algorithm,
elim.pvalue = elim.pvalue, lea.depth = lea.depth, path.mode =
path.mode,
true.path.rule = true.path.rule, verbose = verbose)
if (verbose) {
now &lt;- Sys.time()
message(sprintf("#######################################################",
appendLF = T))
message(sprintf("'xEnricher' has been finished (%s)!",
as.character(now)), appendLF = T)
message(sprintf("#######################################################\n",
appendLF = T))
}
endT &lt;- Sys.time()
runTime &lt;- as.numeric(difftime(strptime(endT, "%Y-%m-%d
%H:%M:%S"),
strptime(startT, "%Y-%m-%d %H:%M:%S"), units = "secs"))
if (!silent) {
message(paste(c("\nEnd at ", as.character(endT)), collapse = ""),
appendLF = TRUE)
message(paste(c("Runtime in total (xEnricherSNPs): ",
runTime, " secs\n"), collapse = ""), appendLF = TRUE)
}
invisible(eTerm)
}
</pre>


</body></html>
