<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title></title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for xEnrichDotplot"><tr><td>xEnrichDotplot</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>xEnrichDotplot</h2>

<h3>Usage</h3>

<pre>
xEnrichDotplot(eTerm, FDR.cutoff = 0.05, colors = c("pink", "red"),
y.scale = c("normal", "log"), slim = NULL, size.range = c(0.5, 3.5),
size.title = "Num of overlaps", label.top = "auto", label.direction.y =
c("left", "right", "none"), label.size = 2, ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>eTerm</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>FDR.cutoff</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>colors</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>y.scale</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>slim</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>size.range</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>size.title</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>label.top</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>label.direction.y</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>label.size</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>


</td></tr>
</table>


<h3>Examples</h3>

<pre>
##---- Should be DIRECTLY executable !! ----
##-- ==&gt;  Define data, use random,
##--	or do  help(data=index)  for the standard data sets.

## The function is currently defined as
function (eTerm, FDR.cutoff = 0.05, colors = c("pink", "red"),
y.scale = c("normal", "log"), slim = NULL, size.range = c(0.5,
3.5), size.title = "Num of overlaps", label.top = "auto",
label.direction.y = c("left", "right", "none"), label.size = 2,
...)
{
y.scale &lt;- match.arg(y.scale)
label.direction.y &lt;- match.arg(label.direction.y)
if (is.null(eTerm)) {
warnings("There is no enrichment in the 'eTerm' object.\n")
return(NULL)
}
if (class(eTerm) == "eTerm") {
df_enrichment_group &lt;- xEnrichViewer(eTerm, top_num = "all",
sortBy = "adjp")
df_enrichment_group$group &lt;- "group"
}
else if (class(eTerm) == "ls_eTerm" | class(eTerm) == "data.frame") {
if (class(eTerm) == "ls_eTerm") {
df_enrichment_group &lt;- eTerm$df
}
else if (class(eTerm) == "data.frame") {
if (all(c("group", "name", "adjp", "nOverlap", "zscore") %in%
colnames(eTerm))) {
df_enrichment_group &lt;- eTerm[, c("group", "name",
"adjp", "nOverlap", "zscore")]
}
else if (all(c("name", "adjp", "nOverlap", "zscore") %in%
colnames(eTerm))) {
df_enrichment_group &lt;- eTerm[, c("name", "adjp",
"nOverlap", "zscore")]
df_enrichment_group$group &lt;- "group"
}
}
}
if (class(df_enrichment_group$group) == "factor") {
if (length(unique(df_enrichment_group$group)) !=
length(levels(df_enrichment_group$group))) {
df_enrichment_group$group &lt;- factor(df_enrichment_group$group,
levels = sort(unique(df_enrichment_group$group)))
}
}
ngroup &lt;- length(unique(df_enrichment_group$group))
adjp &lt;- zscore &lt;- nOverlap &lt;- flag &lt;- name &lt;- group &lt;- rank &lt;- NULL
df_enrichment_group &lt;- df_enrichment_group %&gt;% dplyr::mutate(flag =
ifelse(adjp &gt;=
FDR.cutoff, "N", "Y"))
names(colors) &lt;- c("N", "Y")
gp &lt;- ggplot(df_enrichment_group, aes(x = zscore, y = -log10(adjp),
size = nOverlap))
gp &lt;- gp + geom_point(aes(color = flag, size = nOverlap),
alpha = 0.6)
gp &lt;- gp + scale_colour_manual(values = colors) + guides(color =
"none")
gp &lt;- gp + xlab("Z-score") + ylab(expression(-log[10]("FDR")))
gp &lt;- gp + theme_bw() + theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
if (is.null(slim)) {
slim &lt;- range(df_enrichment_group$nOverlap)
}
if (any(is.na(slim))) {
gp &lt;- gp + theme(legend.position = "none")
}
else {
gp &lt;- gp + theme(legend.position = "bottom", legend.key =
element_rect(colour = "transparent")) +
scale_size_continuous(limits = slim, range = size.range,
guide = guide_legend(size.title, title.position = "left",
nrow = 1))
}
if (label.top == "auto") {
df &lt;- subset(df_enrichment_group, adjp &lt; FDR.cutoff)
}
else {
label.top &lt;- as.integer(label.top)
df &lt;- as.data.frame(df_enrichment_group %&gt;% dplyr::group_by(group)
%&gt;%
dplyr::group_by(rank = rank(adjp), add = TRUE) %&gt;%
dplyr::filter(rank &lt;= label.top &amp; adjp &lt; FDR.cutoff))
}
if (ngroup == 1 &amp; label.direction.y != "none") {
offset &lt;- (range(df_enrichment_group$zscore)[2] -
range(df_enrichment_group$zscore)[1]) *
0.1
if (label.direction.y == "right") {
df$nudge_x &lt;- max(df_enrichment_group$zscore) - df$zscore +
offset
gp &lt;- gp + ggrepel::geom_text_repel(data = df, aes(x = zscore,
y = -log10(adjp), label = name), size = label.size,
show.legend = F, segment.alpha = 0.5, segment.color = "grey50",
segment.size = 0.2, arrow = arrow(length = unit(0.01,
"npc")), direction = "y", hjust = 1, nudge_x = df$nudge_x,
...)
gp &lt;- gp + scale_x_continuous(position = "bottom",
limits = c(min(df_enrichment_group$zscore),
max(df_enrichment_group$zscore) +
offset))
}
else if (label.direction.y == "left") {
df$nudge_x &lt;- -1 * (df$zscore - min(df_enrichment_group$zscore)) -
offset
gp &lt;- gp + ggrepel::geom_text_repel(data = df, aes(x = zscore,
y = -log10(adjp), label = name), size = label.size,
show.legend = F, segment.alpha = 0.5, segment.color = "grey50",
segment.size = 0.2, arrow = arrow(length = unit(0.01,
"npc")), direction = "y", hjust = 0, nudge_x = df$nudge_x,
...)
gp &lt;- gp + scale_x_continuous(position = "bottom",
limits = c(min(df_enrichment_group$zscore) -
offset, max(df_enrichment_group$zscore)))
}
}
else {
gp &lt;- gp + ggrepel::geom_text_repel(data = df, aes(x = zscore,
y = -log10(adjp), label = name), size = label.size,
show.legend = F, segment.alpha = 0.5, segment.color = "grey50",
segment.size = 0.2, arrow = arrow(length = unit(0.01,
"npc")), ...)
}
if (y.scale == "log") {
gp &lt;- gp + scale_y_continuous(trans = "log1p")
}
if (ngroup != 1) {
scales &lt;- "free_y"
space &lt;- "free_y"
gp &lt;- gp + facet_wrap(~group)
}
return(gp)
}
</pre>


</body></html>
