<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title></title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for xSocialiserSNPs"><tr><td>xSocialiserSNPs</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>xSocialiserSNPs</h2>

<h3>Usage</h3>

<pre>
xSocialiserSNPs(data, ontology = c("EF", "EF_disease", "EF_phenotype",
"EF_bp"), include.LD = NA, LD.r2 = 0.8, measure = c("BM.average",
"BM.max", "BM.complete", "average", "max"), method.term = c("Resnik",
"Lin", "Schlicker", "Jiang", "Pesquita"), rescale = TRUE, force = TRUE,
fast = TRUE, parallel = TRUE, multicores = NULL, path.mode =
c("all_paths", "shortest_paths", "all_shortest_paths"), true.path.rule
= T, verbose = T, RData.location =
"http://galahad.well.ox.ac.uk/bigdata", guid = NULL)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>data</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>ontology</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>include.LD</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>LD.r2</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>measure</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>method.term</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>rescale</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>force</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>fast</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>parallel</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>multicores</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>path.mode</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>true.path.rule</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>verbose</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>RData.location</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>guid</code></td>
<td>


</td></tr>
</table>


<h3>Examples</h3>

<pre>
##---- Should be DIRECTLY executable !! ----
##-- ==&gt;  Define data, use random,
##--	or do  help(data=index)  for the standard data sets.

## The function is currently defined as
function (data, ontology = c("EF", "EF_disease", "EF_phenotype",
"EF_bp"), include.LD = NA, LD.r2 = 0.8, measure = c("BM.average",
"BM.max", "BM.complete", "average", "max"), method.term = c("Resnik",
"Lin", "Schlicker", "Jiang", "Pesquita"), rescale = TRUE,
force = TRUE, fast = TRUE, parallel = TRUE, multicores = NULL,
path.mode = c("all_paths", "shortest_paths", "all_shortest_paths"),
true.path.rule = T, verbose = T, RData.location =
"http://galahad.well.ox.ac.uk/bigdata",
guid = NULL)
{
startT &lt;- Sys.time()
message(paste(c("Start at ", as.character(startT)), collapse = ""),
appendLF = T)
message("", appendLF = T)
ontology &lt;- match.arg(ontology)
measure &lt;- match.arg(measure)
method.term &lt;- match.arg(method.term)
path.mode &lt;- match.arg(path.mode)
if (is.vector(data)) {
data &lt;- unique(data)
}
else {
stop("The input data must be a vector.\n")
}
if (!is.na(ontology)) {
if (verbose) {
now &lt;- Sys.time()
message(sprintf("Load the ontology %s and its SNP annotations (%s)
...",
ontology, as.character(now)), appendLF = T)
}
ig &lt;- xRDataLoader(RData = paste("ig.EF", sep = ""),
RData.location = RData.location, guid = guid, verbose = verbose)
if (ontology != "EF") {
if (ontology == "EF_disease") {
node &lt;- "EFO:0000408"
}
else if (ontology == "EF_phenotype") {
node &lt;- "EFO:0000651"
}
else if (ontology == "EF_bp") {
node &lt;- "GO:0008150"
}
neighs.out &lt;- igraph::neighborhood(ig, order = vcount(ig),
nodes = node, mode = "out")
nodeInduced &lt;- V(ig)[unique(unlist(neighs.out))]$name
g &lt;- igraph::induced.subgraph(ig, vids = nodeInduced)
}
else {
g &lt;- ig
}
anno &lt;- xRDataLoader(RData = paste("GWAS2EF", sep = ""),
RData.location = RData.location, guid = guid, verbose = verbose)
if (LD.r2 &gt;= 0.8 &amp; LD.r2 &lt;= 1) {
default.include.LD &lt;- c("ACB", "AFR", "AMR", "ASW",
"BEB", "CDX", "CEU", "CHB", "CHS", "CLM", "EAS",
"ESN", "EUR", "FIN", "GBR", "GIH", "GWD", "IBS",
"ITU", "JPT", "KHV", "LWK", "MSL", "MXL", "PEL",
"PJL", "PUR", "SAS", "STU", "TSI", "YRI")
ind &lt;- match(default.include.LD, include.LD)
include.LD &lt;- default.include.LD[!is.na(ind)]
if (length(include.LD) &gt; 0) {
GWAS_LD &lt;- xRDataLoader(RData = "GWAS_LD", RData.location =
RData.location,
guid = guid, verbose = verbose)
ld.list &lt;- lapply(include.LD, function(x) {
data_ld &lt;- ""
eval(parse(text = paste("data_ld &lt;- GWAS_LD$",
x, sep = "")))
ind &lt;- match(colnames(data_ld), data)
ld &lt;- rownames(data_ld)[which(Matrix::rowSums(data_ld[,
!is.na(ind)] &gt;= LD.r2) &gt; 0)]
ld
})
data &lt;- base::union(unlist(ld.list), data)
}
}
}
else {
stop("There is no input for the ontology.\n")
}
if (verbose) {
now &lt;- Sys.time()
message(sprintf("\n#######################################################",
appendLF = T))
message(sprintf("'xSocialiser' is being called (%s):",
as.character(now)), appendLF = T)
message(sprintf("#######################################################",
appendLF = T))
}
res &lt;- xSocialiser(data = data, annotation = anno, g = g,
measure = measure, method.term = method.term, rescale = rescale,
force = force, fast = fast, parallel = parallel, multicores =
multicores,
path.mode = path.mode, true.path.rule = true.path.rule,
verbose = verbose)
if (!is.null(res)) {
dag &lt;- res$dag
sim_ig &lt;- res
tEdges &lt;- igraph::get.data.frame(sim_ig, what = "edges")
sEdges &lt;- tEdges[with(tEdges, order(-weight, from, to)),
]
relations &lt;- apply(sEdges, 1, function(x) {
if (x[1] &gt; x[2]) {
return(cbind(x[2], x[1], x[3]))
}
else {
x
}
})
relations &lt;- t(relations)
colnames(relations) &lt;- c("from", "to", "weight")
res &lt;- igraph::graph.data.frame(d = relations, directed = F)
if (class(res) == "igraph") {
if (!is.null(E(res)$weight)) {
E(res)$weight &lt;- as.numeric(E(res)$weight)
}
}
res$dag &lt;- dag
}
if (verbose) {
now &lt;- Sys.time()
message(sprintf("#######################################################",
appendLF = T))
message(sprintf("'xSocialiser' has been finished (%s)!",
as.character(now)), appendLF = T)
message(sprintf("#######################################################\n",
appendLF = T))
}
endT &lt;- Sys.time()
message(paste(c("\nEnd at ", as.character(endT)), collapse = ""),
appendLF = T)
runTime &lt;- as.numeric(difftime(strptime(endT, "%Y-%m-%d
%H:%M:%S"),
strptime(startT, "%Y-%m-%d %H:%M:%S"), units = "secs"))
message(paste(c("Runtime in total is: ", runTime, " secs\n"),
collapse = ""), appendLF = T)
invisible(res)
}
</pre>


</body></html>
