<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title></title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for xHeatmap"><tr><td>xHeatmap</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>xHeatmap</h2>

<h3>Usage</h3>

<pre>
xHeatmap(data, reorder = c("none", "row", "col", "both"), colormap =
"spectral", ncolors = 64, zlim = NULL, barwidth = 0.3, barheight =
NULL, nbin = 64, legend.title = "", x.rotate = 90, x.text.size = 6,
x.text.hjust = 0, y.text.size = 6, legend.text.size = 4,
legend.title.size = 6, shape = 19, size = 2, plot.margin = unit(c(5.5,
5.5, 5.5, 5.5), "pt"), font.family = "sans", na.color = "transparent",
data.label = NULL, label.size = 1, label.color = "black", ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>data</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>reorder</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>colormap</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>ncolors</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>zlim</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>barwidth</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>barheight</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>nbin</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>legend.title</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>x.rotate</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>x.text.size</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>x.text.hjust</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>y.text.size</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>legend.text.size</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>legend.title.size</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>shape</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>size</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>plot.margin</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>font.family</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>na.color</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>data.label</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>label.size</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>label.color</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>


</td></tr>
</table>


<h3>Examples</h3>

<pre>
##---- Should be DIRECTLY executable !! ----
##-- ==&gt;  Define data, use random,
##--	or do  help(data=index)  for the standard data sets.

## The function is currently defined as
function (data, reorder = c("none", "row", "col", "both"), colormap =
"spectral",
ncolors = 64, zlim = NULL, barwidth = 0.3, barheight = NULL,
nbin = 64, legend.title = "", x.rotate = 90, x.text.size = 6,
x.text.hjust = 0, y.text.size = 6, legend.text.size = 4,
legend.title.size = 6, shape = 19, size = 2, plot.margin = unit(c(5.5,
5.5, 5.5, 5.5), "pt"), font.family = "sans", na.color = "transparent",
data.label = NULL, label.size = 1, label.color = "black",
...)
{
reorder &lt;- match.arg(reorder)
if (is.null(rownames(data))) {
rownames(data) &lt;- paste("R", 1:nrow(data), sep = "")
}
if (is.null(colnames(data))) {
colnames(data) &lt;- paste("C", 1:ncol(data), sep = "")
}
mat_val &lt;- data
if (!(all(!duplicated(rownames(mat_val))) &amp;
all(!duplicated(colnames(mat_val))))) {
rownames(mat_val) &lt;- make.names(rownames(mat_val), unique = TRUE)
colnames(mat_val) &lt;- make.names(colnames(mat_val), unique = TRUE)
}
flag_factor &lt;- FALSE
if (class(unlist(mat_val)) == "factor") {
lvl &lt;- levels(unlist(mat_val))
indx &lt;- sapply(mat_val, is.factor)
mat_val[indx] &lt;- sapply(mat_val[, indx], function(x) as.numeric(x))
flag_factor &lt;- F
}
if (nrow(mat_val) &gt; 1 &amp; nrow(mat_val) &gt; 1) {
ind_row &lt;- 1:nrow(mat_val)
if (ncol(mat_val) &gt; 1 &amp; (reorder == "row" | reorder ==
"both")) {
mat &lt;- mat_val
colnames(mat) &lt;- 1:ncol(mat)
rownames(mat) &lt;- 1:nrow(mat)
mat[is.na(mat)] &lt;- 0
set.seed(825)
tree_bs &lt;- visTreeBootstrap(mat, visTree = FALSE,
...)
ind_row &lt;- match(tree_bs$tip.label, rownames(mat))
}
ind_col &lt;- 1:ncol(mat_val)
if (nrow(mat_val) &gt; 1 &amp; (reorder == "col" | reorder ==
"both")) {
mat &lt;- mat_val
colnames(mat) &lt;- 1:ncol(mat)
rownames(mat) &lt;- 1:nrow(mat)
mat[is.na(mat)] &lt;- 0
set.seed(825)
tree_bs &lt;- visTreeBootstrap(t(mat), visTree = FALSE,
...)
ind_col &lt;- match(tree_bs$tip.label, colnames(mat))
}
mat_tmp &lt;- as.matrix(mat_val[ind_row, ind_col], ncol = length(ind_col))
rownames(mat_tmp) &lt;- rownames(mat_val)[ind_row]
colnames(mat_tmp) &lt;- colnames(mat_val)[ind_col]
mat_val &lt;- mat_tmp
}
if (class(mat_val) == "matrix") {
mat_val &lt;- as.data.frame(mat_val)
}
if (class(mat_val) == "data.frame") {
if (is.null(zlim)) {
zlim &lt;- c(floor(min(mat_val, na.rm = T) * 10)/10,
ceiling(max(mat_val, na.rm = T) * 10)/10)
if (zlim[1] == zlim[2]) {
zlim[1] &lt;- zlim[2]/2
}
}
mat_val[mat_val &lt;= zlim[1]] &lt;- zlim[1]
mat_val[mat_val &gt;= zlim[2]] &lt;- zlim[2]
gene &lt;- sample &lt;- val &lt;- NULL
df &lt;- mat_val %&gt;% dplyr::mutate(gene = rownames(mat_val)) %&gt;%
tidyr::gather(sample, val, -gene)
df$gene &lt;- factor(df$gene, levels = rev(rownames(mat_val)))
df$sample &lt;- factor(df$sample, levels = colnames(mat_val))
df &lt;- df %&gt;% dplyr::mutate(uid = paste(gene, sample,
sep = ":"))
df$y &lt;- as.numeric(df$gene)
df$x &lt;- as.numeric(df$sample)
if (flag_factor) {
df$val &lt;- factor(df$val, levels = unique(df$val))
}
gp &lt;- ggplot(df, aes(x = sample, y = gene, color = val))
gp &lt;- gp + geom_point(size = size, shape = shape)
if (!flag_factor) {
gp &lt;- gp + scale_colour_gradientn(colors =
xColormap(colormap)(ncolors),
limits = zlim, guide = guide_colorbar(title = legend.title,
title.position = "top", barwidth = barwidth,
barheight = barheight, nbin = nbin, draw.ulim = FALSE,
draw.llim = FALSE), na.value = na.color)
}
else {
gp &lt;- gp + scale_colour_manual(legend.title, values =
xColormap(colormap)(length(lvl)),
labels = lvl)
if (is.null(barheight)) {
barheight &lt;- barwidth
}
gp &lt;- gp + theme(legend.key.width = unit(barwidth,
"pt"), legend.key.height = unit(barheight, "pt")) +
guides(col = guide_legend(ncol = 1))
}
gp &lt;- gp + theme_bw() + theme(legend.position = "right",
axis.title.x = element_blank(), axis.title.y = element_blank(),
axis.text.x = element_text(face = "bold", color = "black",
size = x.text.size, angle = x.rotate, hjust = x.text.hjust),
axis.text.y = element_text(face = "bold", color = "black",
size = y.text.size, angle = 0), panel.background = element_rect(fill =
"transparent")) +
theme(panel.grid.major = element_blank(), panel.grid.minor =
element_blank()) +
theme(plot.margin = plot.margin) + theme(legend.title =
element_text(face = "bold",
color = "black", size = legend.title.size), legend.text =
element_text(face = "bold",
color = "black", size = legend.text.size), legend.title.align = 0.5) +
theme(legend.background = element_rect(fill = "transparent"))
gp &lt;- gp + theme(axis.ticks = element_line(size = 0.25),
axis.ticks.length = unit(0.1, "cm"))
gp &lt;- gp + theme(text = element_text(family = font.family))
gp_main &lt;- gp + scale_x_discrete(position = "top")
if (!is.null(data.label)) {
mat_label &lt;- as.data.frame(data.label[ind_row, ind_col],
stringsAsFactors = F)
gene &lt;- sample &lt;- val &lt;- NULL
df_label &lt;- suppressWarnings(mat_label %&gt;% dplyr::mutate(gene =
rownames(mat_label)) %&gt;%
tidyr::gather(sample, val, -gene))
df_label$gene &lt;- factor(df_label$gene, levels =
rev(rownames(mat_label)))
df_label$sample &lt;- factor(df_label$sample, levels =
colnames(mat_label))
df_label &lt;- df_label %&gt;% dplyr::mutate(uid = paste(gene,
sample, sep = ":"))
df_label$y &lt;- as.numeric(df_label$gene)
df_label$x &lt;- as.numeric(df_label$sample)
gp_main &lt;- gp_main + geom_text(data = df_label, aes(x = sample,
y = gene, label = val), hjust = 0.5, vjust = 0.5,
size = label.size, color = label.color)
}
invisible(gp_main)
}
else {
return(NULL)
}
}
</pre>


</body></html>
