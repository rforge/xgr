<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title></title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for xSNP2GeneScores"><tr><td>xSNP2GeneScores</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>xSNP2GeneScores</h2>

<h3>Usage</h3>

<pre>
xSNP2GeneScores(data, include.LD = NA, LD.customised = NULL, LD.r2 =
0.8, significance.threshold = 5e-05, score.cap = 10, distance.max =
50000, decay.kernel = c("slow", "linear", "rapid", "constant"),
decay.exponent = 2, GR.SNP = c("dbSNP_GWAS", "dbSNP_Common",
"dbSNP_Single"), GR.Gene = c("UCSC_knownGene", "UCSC_knownCanonical"),
include.TAD = c("none", "GM12878", "IMR90", "MSC", "TRO", "H1", "MES",
"NPC"), scoring.scheme = c("max", "sum", "sequential"), verbose = T,
RData.location = "http://galahad.well.ox.ac.uk/bigdata", guid = NULL)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>data</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>include.LD</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>LD.customised</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>LD.r2</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>significance.threshold</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>score.cap</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>distance.max</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>decay.kernel</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>decay.exponent</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>GR.SNP</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>GR.Gene</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>include.TAD</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>scoring.scheme</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>verbose</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>RData.location</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>guid</code></td>
<td>


</td></tr>
</table>


<h3>Examples</h3>

<pre>
##---- Should be DIRECTLY executable !! ----
##-- ==&gt;  Define data, use random,
##--	or do  help(data=index)  for the standard data sets.

## The function is currently defined as
function (data, include.LD = NA, LD.customised = NULL, LD.r2 = 0.8,
significance.threshold = 5e-05, score.cap = 10, distance.max = 50000,
decay.kernel = c("slow", "linear", "rapid", "constant"),
decay.exponent = 2, GR.SNP = c("dbSNP_GWAS", "dbSNP_Common",
"dbSNP_Single"), GR.Gene = c("UCSC_knownGene", "UCSC_knownCanonical"),
include.TAD = c("none", "GM12878", "IMR90", "MSC", "TRO",
"H1", "MES", "NPC"), scoring.scheme = c("max", "sum",
"sequential"), verbose = T, RData.location =
"http://galahad.well.ox.ac.uk/bigdata",
guid = NULL)
{
decay.kernel &lt;- match.arg(decay.kernel)
include.TAD &lt;- match.arg(include.TAD)
scoring.scheme &lt;- match.arg(scoring.scheme)
if (verbose) {
now &lt;- Sys.time()
message(sprintf("\n#######################################################",
appendLF = T))
message(sprintf("'xSNPscores' is being called to score SNPs (%s):",
as.character(now)), appendLF = T)
message(sprintf("#######################################################",
appendLF = T))
}
df_SNP &lt;- xSNPscores(data = data, include.LD = include.LD,
LD.customised = LD.customised, LD.r2 = LD.r2, significance.threshold =
significance.threshold,
score.cap = score.cap, verbose = verbose, RData.location =
RData.location,
guid = guid)
if (verbose) {
now &lt;- Sys.time()
message(sprintf("#######################################################",
appendLF = T))
message(sprintf("'xSNPscores' has been finished (%s)!",
as.character(now)), appendLF = T)
message(sprintf("#######################################################\n",
appendLF = T))
}
if (verbose) {
now &lt;- Sys.time()
message(sprintf("\n#######################################################",
appendLF = T))
message(sprintf("'xSNP2nGenes' is being called to define nearby genes
(%s):",
as.character(now)), appendLF = T)
message(sprintf("#######################################################",
appendLF = T))
}
df_nGenes &lt;- xSNP2nGenes(data = df_SNP$SNP, distance.max =
distance.max,
decay.kernel = decay.kernel, decay.exponent = decay.exponent,
GR.SNP = GR.SNP, GR.Gene = GR.Gene, include.TAD = include.TAD,
verbose = verbose, RData.location = RData.location, guid = guid)
if (include.TAD != "none") {
TAD &lt;- NULL
df_nGenes &lt;- base::subset(df_nGenes, TAD != "Excluded")
}
if (verbose) {
now &lt;- Sys.time()
message(sprintf("#######################################################",
appendLF = T))
message(sprintf("'xSNP2nGenes' has been finished (%s)!",
as.character(now)), appendLF = T)
message(sprintf("#######################################################\n",
appendLF = T))
}
allGenes &lt;- sort(df_nGenes$Gene)
allSNPs &lt;- sort(df_SNP$SNP)
G2S_n &lt;- xSparseMatrix(df_nGenes[, c("Gene", "SNP", "Weight")],
rows = allGenes, columns = allSNPs, verbose = verbose)
G2S &lt;- G2S_n
ind &lt;- match(colnames(G2S), df_SNP$SNP)
df_SNP &lt;- df_SNP[ind, ]
SNP_score &lt;- df_SNP$Score
names(SNP_score) &lt;- colnames(G2S)
mat_SNP_score &lt;- matrix(rep(SNP_score, each = nrow(G2S)),
nrow = nrow(G2S))
G2S_score &lt;- G2S * mat_SNP_score
Gene2SNP &lt;- xSM2DF(data = G2S_score, verbose = FALSE)
colnames(Gene2SNP) &lt;- c("Gene", "SNP", "Score")
ls_gene &lt;- split(x = Gene2SNP$Score, f = Gene2SNP$Gene)
if (scoring.scheme == "max") {
seeds.genes &lt;- sapply(ls_gene, max)
}
else if (scoring.scheme == "sum") {
seeds.genes &lt;- sapply(ls_gene, sum)
}
else if (scoring.scheme == "sequential") {
seeds.genes &lt;- sapply(ls_gene, function(x) {
base::sum(x/base::rank(-x, ties.method = "min"))
})
}
x &lt;- seeds.genes
pval &lt;- 10^(-1 * x)
df_Gene &lt;- data.frame(Gene = names(seeds.genes), Score = seeds.genes,
Pval = pval, row.names = NULL, stringsAsFactors = F)
df_Gene &lt;- df_Gene[order(df_Gene$Score, decreasing = TRUE),
]
if (verbose) {
now &lt;- Sys.time()
message(sprintf("In summary, %d Genes are defined as seeds and scored
using '%s' scoring scheme",
length(seeds.genes), scoring.scheme, as.character(now)),
appendLF = T)
}
df_SNP &lt;- df_SNP[order(df_SNP$Flag, df_SNP$Score, -df_SNP$Pval,
df_SNP$SNP, decreasing = TRUE), ]
mSeed &lt;- list(SNP = df_SNP, Gene = df_Gene, Call = match.call())
class(mSeed) &lt;- "mSeed"
invisible(mSeed)
}
</pre>


</body></html>
