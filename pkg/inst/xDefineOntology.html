<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title></title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for xDefineOntology"><tr><td>xDefineOntology</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>xDefineOntology</h2>

<h3>Usage</h3>

<pre>
xDefineOntology(ontology = c(NA, "GOBP", "GOMF", "GOCC", "PSG", "PS",
"PS2", "SF", "Pfam", "DO", "HPPA", "HPMI", "HPCM", "HPMA", "MP", "EF",
"MsigdbH", "MsigdbC1", "MsigdbC2CGP", "MsigdbC2CPall", "MsigdbC2CP",
"MsigdbC2KEGG", "MsigdbC2REACTOME", "MsigdbC2BIOCARTA", "MsigdbC3TFT",
"MsigdbC3MIR", "MsigdbC4CGN", "MsigdbC4CM", "MsigdbC5BP", "MsigdbC5MF",
"MsigdbC5CC", "MsigdbC6", "MsigdbC7", "DGIdb", "GTExV4", "GTExV6p",
"GTExV7", "CreedsDisease", "CreedsDiseaseUP", "CreedsDiseaseDN",
"CreedsDrug", "CreedsDrugUP", "CreedsDrugDN",
"CreedsGene", "CreedsGeneUP", "CreedsGeneDN", "KEGG", "KEGGmetabolism",
"KEGGgenetic", "KEGGenvironmental", "KEGGcellular", "KEGGorganismal",
"KEGGdisease", "REACTOME", "REACTOME_ImmuneSystem",
"REACTOME_SignalTransduction", "CGL", "SIFTS2GOBP", "SIFTS2GOMF",
"SIFTS2GOCC", "EnrichrARCHS4Cells", "EnrichrARCHS4Tissues",
"EnrichrHumanGeneAtlas", "EnrichrTissueHumanProteomeMap",
"EnrichrTissueProteomicsDB", "EnrichrAchillesFitnessD",
"EnrichrAchillesFitnessI", "EnrichrDSigDB", "EnrichrOMIM",
"EnrichrOMIMexpanded",
"EnrichrdbGaP", "EnrichrJensenDiseases", "EnrichrJensenTissues",
"EnrichrBioCarta", "EnrichrKEGG", "EnrichrNCIpathway",
"EnrichrPanther", "EnrichrReactome", "EnrichrWikiPathways",
"EnrichrhuMAP", "EnrichrChEA", "EnrichrConsensusTFs",
"EnrichrEncodeTF", "EnrichrTFlof", "EnrichrTFpert"),
ontology.customised = NULL, anno.identity = c("GeneID", "Symbol"),
verbose = T, RData.location = "http://galahad.well.ox.ac.uk/bigdata",
guid = NULL)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>ontology</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>ontology.customised</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>anno.identity</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>verbose</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>RData.location</code></td>
<td>


</td></tr>
<tr valign="top"><td><code>guid</code></td>
<td>


</td></tr>
</table>


<h3>Examples</h3>

<pre>
##---- Should be DIRECTLY executable !! ----
##-- ==&gt;  Define data, use random,
##--	or do  help(data=index)  for the standard data sets.

## The function is currently defined as
function (ontology = c(NA, "GOBP", "GOMF", "GOCC", "PSG", "PS",
"PS2", "SF", "Pfam", "DO", "HPPA", "HPMI", "HPCM", "HPMA",
"MP", "EF", "MsigdbH", "MsigdbC1", "MsigdbC2CGP", "MsigdbC2CPall",
"MsigdbC2CP", "MsigdbC2KEGG", "MsigdbC2REACTOME", "MsigdbC2BIOCARTA",
"MsigdbC3TFT", "MsigdbC3MIR", "MsigdbC4CGN", "MsigdbC4CM",
"MsigdbC5BP", "MsigdbC5MF", "MsigdbC5CC", "MsigdbC6", "MsigdbC7",
"DGIdb", "GTExV4", "GTExV6p", "GTExV7", "CreedsDisease",
"CreedsDiseaseUP", "CreedsDiseaseDN", "CreedsDrug", "CreedsDrugUP",
"CreedsDrugDN", "CreedsGene", "CreedsGeneUP", "CreedsGeneDN",
"KEGG", "KEGGmetabolism", "KEGGgenetic", "KEGGenvironmental",
"KEGGcellular", "KEGGorganismal", "KEGGdisease", "REACTOME",
"REACTOME_ImmuneSystem", "REACTOME_SignalTransduction", "CGL",
"SIFTS2GOBP", "SIFTS2GOMF", "SIFTS2GOCC", "EnrichrARCHS4Cells",
"EnrichrARCHS4Tissues", "EnrichrHumanGeneAtlas",
"EnrichrTissueHumanProteomeMap",
"EnrichrTissueProteomicsDB", "EnrichrAchillesFitnessD",
"EnrichrAchillesFitnessI",
"EnrichrDSigDB", "EnrichrOMIM", "EnrichrOMIMexpanded", "EnrichrdbGaP",
"EnrichrJensenDiseases", "EnrichrJensenTissues", "EnrichrBioCarta",
"EnrichrKEGG", "EnrichrNCIpathway", "EnrichrPanther",
"EnrichrReactome",
"EnrichrWikiPathways", "EnrichrhuMAP", "EnrichrChEA",
"EnrichrConsensusTFs",
"EnrichrEncodeTF", "EnrichrTFlof", "EnrichrTFpert"),
ontology.customised = NULL,
anno.identity = c("GeneID", "Symbol"), verbose = T, RData.location =
"http://galahad.well.ox.ac.uk/bigdata",
guid = NULL)
{
anno.identity &lt;- match.arg(anno.identity)
ontology &lt;- ontology[1]
ontology.input &lt;- ontology
g &lt;- NULL
anno &lt;- NULL
if (!is.null(ontology.customised)) {
if (class(ontology.customised) == "GS") {
GS &lt;- ontology.customised
anno &lt;- GS$gs
nodes &lt;- data.frame(name = as.character(GS$set_info$setID),
term_id = as.character(GS$set_info$setID), term_name =
as.character(GS$set_info$name),
term_distance = as.character(GS$set_info$distance),
term_namespace = as.character(GS$set_info$namespace),
stringsAsFactors = F)
nodes &lt;- rbind(nodes, c("root", "root", "root", "root",
"root"))
relations &lt;- data.frame(from = "root", to = nodes$name)
g &lt;- igraph::graph.data.frame(d = relations, directed = T,
vertices = nodes)
g$type &lt;- "iso"
ontology.input &lt;- "customised"
}
}
else {
if (!is.na(ontology)) {
if (verbose) {
message(sprintf("Load the ontology %s and its gene annotations (%s)
...",
ontology, as.character(Sys.time())), appendLF = T)
}
flag_PS2 &lt;- FALSE
if (ontology == "PS2") {
flag_PS2 &lt;- TRUE
ontology &lt;- "PS"
}
flag_REACTOME &lt;- FALSE
if (grepl("REACTOME_", ontology)) {
flag_REACTOME &lt;- TRUE
ontology_REACTOME &lt;- ontology
ontology &lt;- "REACTOME"
}
GS &lt;- xRDataLoader(paste("org.Hs.eg", ontology, sep = ""),
RData.location = RData.location, guid = guid,
verbose = verbose)
if (flag_PS2) {
tmp &lt;- as.character(unique(GS$set_info$name))
inds &lt;- sapply(tmp, function(x) which(GS$set_info$name ==
x))
set_info &lt;- data.frame()
for (i in 1:length(inds)) {
set_info &lt;- rbind(set_info, as.matrix(GS$set_info[max(inds[[i]]),
]))
}
gs &lt;- list()
for (i in 1:length(inds)) {
gs[[i]] &lt;- unlist(GS$gs[inds[[i]]], use.names = F)
}
names(gs) &lt;- rownames(set_info)
GS$set_info &lt;- set_info
GS$gs &lt;- gs
}
if (flag_REACTOME) {
flag &lt;- unlist(strsplit(ontology_REACTOME, "_"))[2]
if (flag %in% GS$set_info$namespace) {
GS$set_info &lt;- GS$set_info[GS$set_info$namespace ==
flag, ]
ind &lt;- match(names(GS$gs), GS$set_info$setID)
GS$gs &lt;- GS$gs[!is.na(ind)]
}
}
anno &lt;- GS$gs
if (anno.identity == "Symbol") {
EG &lt;- xRDataLoader(RData.customised = paste("org.Hs.eg",
sep = ""), RData.location = RData.location,
guid = guid, verbose = verbose)
anno_symbols &lt;- lapply(anno, function(x) {
xGeneID2Symbol(x, org = EG, details = F, verbose = F)
})
anno &lt;- anno_symbols
}
all.ontologies &lt;- c("GOBP", "GOMF", "GOCC", "DO",
"HPPA", "HPMI", "HPCM", "HPMA", "MP", "EF", "SIFTS2GOBP",
"SIFTS2GOMF", "SIFTS2GOCC", "REACTOME")
flag_ontology &lt;- ontology %in% all.ontologies
if (flag_ontology) {
ontology &lt;- gsub("^SIFTS2", "", ontology)
g &lt;- xRDataLoader(RData.customised = paste("ig.",
ontology, sep = ""), RData.location = RData.location,
guid = guid, verbose = verbose)
if (is.null(V(g)$term_namespace)) {
V(g)$term_namespace &lt;- ontology
}
if (flag_REACTOME) {
if (0) {
g &lt;- dnet::dDAGinduce(g, nodes_query = GS$set_info$setID,
path.mode = "all_paths")
}
else {
ind &lt;- match(V(g)$name, GS$set_info$setID)
vids &lt;- V(g)$name[!is.na(ind)]
neighs.in &lt;- igraph::neighborhood(g, order = vcount(g),
nodes = vids, mode = "in")
neighbors &lt;- unique(names(unlist(neighs.in)))
g &lt;- dnet::dNetInduce(g, nodes_query = neighbors,
knn = 0, remove.loops = TRUE, largest.comp = T)
}
}
g$type &lt;- "dag"
}
else {
nodes &lt;- data.frame(name = as.character(GS$set_info$setID),
term_id = as.character(GS$set_info$setID),
term_name = as.character(GS$set_info$name),
term_distance = as.character(GS$set_info$distance),
term_namespace = as.character(GS$set_info$namespace),
stringsAsFactors = F)
nodes &lt;- rbind(nodes, c("root", "root", "root",
"root", "root"))
relations &lt;- data.frame(from = "root", to = nodes$name)
g &lt;- igraph::graph.data.frame(d = relations,
directed = T, vertices = nodes)
g$type &lt;- "iso"
}
}
}
g$ontology &lt;- ontology.input
aOnto &lt;- list(g = g, anno = anno)
class(aOnto) &lt;- "aOnto"
invisible(aOnto)
}
</pre>


</body></html>
